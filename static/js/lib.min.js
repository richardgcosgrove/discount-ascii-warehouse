"use strict";var adsController=function(){function t(){return Math.floor(1e4*Math.random())}var n=null,e=function(){for(var e=t();n===e;)e=t();return n=e,e};return{getAd:e}}(),productsController=function(){function t(t){u=!0,++c,$(".products").append('<div class="product container" style="">\n            <img class="product__ad" src="/ad/?r='+adsController.getAd()+'"/>\n        </div>'),a.unshift(t)}function n(n){var o=n;return l.indexOf(n)===-1&&(++d,u||(d-1)%20!==0?e(o):t(o),!0)}function e(t){u=!1;var n=new Date(t.date),e=Date.now()-n.getTime();n=e>p?r(n.getMonth(),2)+"/"+r(n.getDate(),2)+"/"+r(n.getFullYear(),4):Math.floor(e/g)+" days ago",$(".products").append('<div class="product container">\n                <div class="product__face" style="font-size: '+t.size+'px" >'+t.face+'</div>\n                <div class="product__size" >size: '+t.size+'px</div>\n                <div class="product__price">price: $'+(.01*t.price).toFixed(2)+'</div>\n                <div class="product__date">date: '+n+"</div>\n            </div>"),l.push(t)}function o(){document;return Math.ceil($("body").width()/h)}function i(){var t=document;return Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight,t.body.clientHeight,t.documentElement.clientHeight)}function r(t,n,e){return e=e||"0",t+="",t.length>=n?t:new Array(n-t.length+1).join(e)+t}var c=0,d=0,u=!0,a=[],s=void 0,l=[],f=250,h=490,p=6048e5,g=864e5,v="",m=function(){var t=arguments.length<=0||void 0===arguments[0]?2:arguments[0];a.length>0&&!function(){var e=o(),i=d%e,r=e*t-i,c=0,s=a.slice(0,r);s.map(function(t){if(c<r&&n(t)){if(a.shift(),++c>r)return;if(u&&n(t)&&(a.shift(),++c>r))return}})}()},y=function(){c=1,u=!0,a=[],l=[],a=[],s=null,d=0,$(".products").empty(),$(".endOfTheLine").hide(),$(".products").hide(),$(".loading").slideDown("1000");for(var t=i(),n=$("body").height(),e=0,o=f;o+n<t;o+=f)++e;_(e+20).then(function(){$(".loading").slideUp(500,function(){m(e),$(".products").fadeIn(1500),$(".endOfTheLine").show(),_(20)})})},_=function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=o()*t;if(!(n<0)){if(s)return s;var e=$.get("/api/products?limit="+n+("&skip="+l.length)+(""!==v?"&sort="+v:""),function(t){try{if(!t||t.length<0)return;var n="[".concat(t.replace(/\n/g,","));n=n.substr(0,n.length-1),n=n.concat("]"),n=JSON.parse(n),$.each(n,function(t,n){a.push(n)})}catch(n){console.log(n),console.log(t)}},"text");return e.then(function(){s=null}),s=e,e}};return{addRows:m,load:y,pending:a,pendingAction:s,pendRows:_,products:l}}();