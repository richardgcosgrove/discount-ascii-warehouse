"use strict";var adsController=function(){function t(){return Math.floor(1e4*Math.random())}var n=null,e=function(){for(var e=t();n===e;)e=t();return n=e,e};return{getAd:e}}(),productsController=function(){function t(t){a=!0,++d,$(".products").append('<div class="product container" style="">\n            <img class="product__ad" src="/ad/?r='+adsController.getAd()+'"/>\n        </div>'),s.unshift(t)}function n(n){var o=n;return f.indexOf(n)===-1&&(++u,a||(u-1)%20!==0?e(o):t(o),!0)}function e(t){a=!1;var n=new Date(t.date),e=Date.now()-n.getTime();n=e>g?c(n.getMonth(),2)+"/"+c(n.getDate(),2)+"/"+c(n.getFullYear(),4):Math.floor(e/v)+" days ago",$(".products").append('<div class="product container">\n                <div class="product__face" style="font-size: '+t.size+'px" >'+t.face+'</div>\n                <div class="product__size" >size: '+t.size+'px</div>\n                <div class="product__price">price: $'+(.01*t.price).toFixed(2)+'</div>\n                <div class="product__date">date: '+n+"</div>\n            </div>"),f.push(t)}function o(t){m=t,_()}function i(){document;return Math.ceil($("body").width()/p)}function r(){var t=document;return Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight,t.body.clientHeight,t.documentElement.clientHeight)}function c(t,n,e){return e=e||"0",t+="",t.length>=n?t:new Array(n-t.length+1).join(e)+t}var d=0,u=0,a=!0,s=[],l=void 0,f=[],h=250,p=490,g=6048e5,v=864e5,m="",y=function(){var t=arguments.length<=0||void 0===arguments[0]?2:arguments[0];s.length>0&&!function(){var e=i(),o=u%e,r=e*t-o,c=0,d=s.slice(0,r);d.map(function(t){if(c<r&&n(t)){if(s.shift(),++c>r)return;if(a&&n(t)&&(s.shift(),++c>r))return}})}()},_=function(){d=1,a=!0,s=[],f=[],s=[],l=null,u=0,$(".products").empty(),$(".endOfTheLine").hide(),$(".products").hide(),$(".loading").slideDown("1000");for(var t=r(),n=$("body").height(),e=0,o=h;o+n<t;o+=h)++e;w(e+20).then(function(){$(".loading").slideUp(500,function(){y(e),$(".products").fadeIn(1500),$(".endOfTheLine").show(),w(20)})})},w=function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=i()*t;if(!(n<0)){if(l)return l;var e=$.get("/api/products?limit="+n+("&skip="+f.length)+(""!==m?"&sort="+m:""),function(t){try{if(!t||t.length<0)return;var n="[".concat(t.replace(/\n/g,","));n=n.substr(0,n.length-1),n=n.concat("]"),n=JSON.parse(n),$.each(n,function(t,n){s.push(n)})}catch(n){console.log(n),console.log(t)}},"text");return e.then(function(){l=null}),l=e,e}};return{addRows:y,changeSort:o,load:_,pending:s,pendingAction:l,pendRows:w,products:f}}();